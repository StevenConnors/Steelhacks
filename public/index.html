<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>MonumentVR - SteelHacks 2016</title>
    <script src="https://aframe.io/releases/latest/aframe.js"></script>
    <script src="js/bundle.js"></script>
    <script src="js/aframe-text-component.min.js"></script>
    <style>
      #audio {
        position: absolute;
        bottom: 5px;
        left: 5px;
        width: 240px;
        z-index: 1;
      }
      @media (min-width: 480px) {
        #audio {
          bottom: 20px;
          left: 20px;
          width: 300px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Assests which aid the coloring of the objects -->
    <a-assets>
      <img id="my-texture"       src="/assets/monu9-nopillarnoz.png">
      <img id="pillar-texture"   src="/assets/monu9-pillar.png">
      <img id="Lshape-texture"   src="/assets/monu9-L.png">
      <img id="Zshape-texture"   src="/assets/monu9-Z.png">
      <img id="button-texture"   src="/assets/monu9-button.png">
      <img id="stair-texture"    src="/assets/monu9-stair.png">
      <img id="treasure-texture" src="/assets/treasure.png">
    </a-assets>

    <!-- Scene to render on the web page -->
    <a-scene terrain="#terrain [geometry], #scene" stats="false">

      <!-- Player object -->
      <a-entity id="player" 
                position="-40 1.7 -25" 
                camera
                fov="90"
                look-controls
                keyboard-controls="acceleration: 200"
                jump-ability="enableDoubleJump: true;
                              soundJump: #sound-jump;
                              soundLand: #sound-land;">
        <!-- Sound objects -->
        <a-entity id="sound-jump"
                  sound="src: /assets/mariojumpsound.mp3;
                         on: fire;">
        </a-entity>

        <a-entity id="sound-land"
                  sound="src: https://sandbox.donmccurdy.com/assets/sound/footfall.mp3;
                         on: fire;
                         volume: 2;">
        </a-entity>

        <!-- Cursor object -->
        <a-entity cursor="fuse: true; timeout: 100; maxDistance: 35;" 
                  geometry="primitive:ring; radiusInner:0.02; radiusOuter:0.03" 
                  material="color: #4CC3D9" 
                  position="0 0 -2">
        </a-entity>
      </a-entity>
      <!-- End Player object -->

      <!-- Scene entity. Everything that is landable must be included within this object -->
      <a-entity id="scene">

        <!-- Hint Entities -->
        <a-entity id = "first-hint"
                 class = "hint"
                 text="text: Move using WASD and Jump with Space! Press H to toggle hints" 
                 position="-50 2 -30" 
                 material="color: red"
                 opacity="1"
                 transparent="false">
          <a-animation attribute="position" begin="hide-hint" to="100 -100 100"></a-animation> 
          <a-animation attribute="position" begin="show-hint" to="-50 2 -30"></a-animation> 
        </a-entity>

        <a-entity id = "second-hint"
                  class = "hint"
                  text="text: Stare at Button and Look Behind You!" 
                  position="-15 8 -45"  
                  material="color: red"
                  opacity="1"
                  transparent="false">
          <a-animation attribute="position" begin="hide-hint" to="100 -100 100"></a-animation> 
          <a-animation attribute="position" begin="show-hint" to="-15 8 -45"></a-animation> 
        </a-entity>
         
        <a-entity id = "third-hint"
                  class = "hint"
                  text="text: Come Here and Look up at the blue handles!" 
                  position="5 25 -20" 
                  rotation="0 180 0"
                  material="color: red"
                  opacity="1"
                  ransparent="false">
          <a-animation attribute="position" begin="hide-hint" to="100 -100 100"></a-animation> 
          <a-animation attribute="position" begin="show-hint" to="5 25 -20"></a-animation> 
        </a-entity>
        <!-- End Hints -->

        <!-- Various model entities -->
        <a-model rotation="0 -90 0"  
                 scale="1 1 1" 
                 position="0 0 0" 
                 src="/assets/monu9-nopillarnoz.dae"
                 material="#my-texture"
                 id="model">
        </a-model>

        <a-model id="pillar" 
                 rotation="0 -90 0" 
                 scale="1 1 1" 
                 position-"0 0 0" 
                 src="/assets/monu9-pillar.dae" 
                 material="src: #pillar-texture" 
                 visible="true">
          <a-animation attribute="scale" begin="scale-pillar" to="1 3.4 1" dur="3000"></a-animation>
        </a-model>

        <a-model id="L-shape"  
                 rotation="0 90 0" 
                 scale="1 1 1" 
                 position="0 0 0" 
                 src="/assets/monu9-L.dae" 
                 material="src: #Lshape-texture"
                 visible="true">
          <a-animation attribute="position" begin="L-shape-scale" to="0 37 0" dur="3000"></a-animation>
          <a-animation attribute="rotation" begin="L-shape-rotate1" to="0 0 0" dur="2000"></a-animation>
          <a-animation attribute="rotation" begin="L-shape-rotate2" to="0 90 0" dur="2000"></a-animation>
          <a-animation attribute="rotation" begin="L-shape-rotate3" to="0 180 0" dur="2000"></a-animation>
          <a-animation attribute="rotation" begin="L-shape-rotate4" from="0 -180 0" to="0 -90 0" dur="2000"></a-animation>
        </a-model>

        <a-model id="Z-shape"
                 rotation="0 -90 0"
                 scale= "1 1 1"
                 position-"0 0 0"
                 src="/assets/monu9-Z.dae"
                 material="src:#Zshape-texture"
                 visible="true">
          <a-animation attribute="scale" begin="Z-shape-scale" to="1 11.3 1" dur="9000"></a-animation>
          <a-animation attribute="position" begin="Z-shape-pos" to="0 -12 0" dur="9000"></a-animation>
        </a-model>

        <a-model id="button"
                 rotation="0 -90 0"
                 scale= "1 1 1"
                 position-"0 0 0"
                 src="/assets/monu9-button.dae"
                 material="src:#button-texture"
                 visible="true">
          <a-animation attribute="position" begin="button-scale" to="0 19 0" dur="9000"></a-animation>
        </a-model>

        <a-model id="stair"
                 rotation="0 -90 0"
                 scale= "1 1 1"
                 position-"0 0 0"
                 src="/assets/monu9-stair.dae"
                 material="src:#stair-texture"
                 visible="false">
          <a-animation attribute="visible" begin="stair-visibility" to="true" dur="3000"></a-animation>
        </a-model>

        <!-- The cubes below are overlapped with points where the user needs to gaze to activate an event. -->
        <!-- Its coded like this becuase a-model does not respond to gaze events, while a transparent a-cube does -->
        <a-cube id="pcover" 
                position="-15 0 23" 
                transparent="true"
                opacity="0"
                rotation="0 -90 0" 
                width="6" 
                height="3" 
                depth="6">   
            <a-animation attribute="position" begin="pcover-scale" to="-15 21 23" dur="9000"></a-animation> 
        </a-cube>

        <a-cube id="bluecover"
                position="0 47 4"
                transparency = "true"
                opacity = "0"
                rotation="0 90 0"
                width="12"
                height="3"
                depth="12">
          <a-animation attribute="position" begin="blue-shift" to="0 80 4" dur="3000"></a-animation>
        </a-cube>

        <a-cube id="FButtonCover" 
                position="-15 7 -39" 
                transparent="true"
                opacity="0"
                rotation="0 -90 0" 
                width="6" 
                height="3" 
                depth="6">
        </a-cube>

        <a-model id="treasureBox" 
                material="src:#treasure-texture"
                src="/assets/treasure.dae"
                position="38 59.5 40" 
                rotation="0 90 0" 
                scale="0.4 0.4 0.4">
        </a-model>

        <a-cube id="treasureBoxMock" 
                position="38 59.5 40" 
                transparent="true"
                opacity="0"
                rotation="0 -90 0" 
                width="3" 
                height="3" 
                depth="3">
        </a-cube>

        <!-- Celebration Video -->
        <a-video id="congratsVid"
                 src="/assets/Rick_Astley_-_Never_Gonna_Give_You_Up.mp4" 
                 autoplay="false"
                 width="6" 
                 height="4" 
                 position="38 65 40"
                 rotation="0 180 0">
                 <a-animation attribute="autoplay" begin="playVid" to="true"></a-animation>
        </a-video>

      </a-entity>
      <!-- End Scene -->

      <!-- Terrain Object. Do not touch. -->
      <a-cube id="terrain"
              height="1"
              width="1000"
              depth="1000"
              color="#BCDFFF">
      </a-cube>
      <!-- End Terrain -->
      
      <!-- Sky -->
      <a-sky id="sky" color="#AADDF0"></a-sky>
      <!-- End Sky -->

      <!-- Lighting -->
      <a-light type="ambient" color="#ccc"></a-light>
      <a-light color="#ddf" position="0 30 0" distance="100" intensity="0.4" type="point"></a-light>
      <a-light color="#ddf" position="3 10 -10" distance="50" intensity="0.4" type="point"></a-light>
      <!-- End Lighting -->
    </a-scene>
   <script language="javascript">
      var checkValues = function (res, x, y, z) {
        return ((x == res.x) && (y == res.y) && (z == res.z));
      }

      document.querySelector('#pcover').addEventListener('click', function() {
        document.querySelector('#L-shape').emit('L-shape-scale');
        document.querySelector('#stair').emit('stair-visibility');
        document.querySelector('#pillar').emit('scale-pillar');
        document.querySelector('#bluecover').emit('blue-shift');
          });

      document.querySelector('#FButtonCover').addEventListener('click', function () {
        document.querySelector('#Z-shape').emit('Z-shape-scale');
        document.querySelector('#Z-shape').emit('Z-shape-pos');
        document.querySelector('#button').emit('button-scale');
        document.querySelector('#pcover').emit('pcover-scale');
          });

      document.querySelector('#treasureBoxMock').addEventListener('click', function () {
        document.querySelector('#congratsVid').emit('playVid');
          });

      document.querySelector('#bluecover').addEventListener('click', function(){



        var getAttrResult =document.querySelector('#L-shape').getAttribute("rotation"); 
        console.log(getAttrResult);
        if (checkValues(getAttrResult, 0, -90, 0)) {
          console.log("in 1");
          document.querySelector('#L-shape').emit('L-shape-rotate1');
        }
        else if(checkValues(getAttrResult, 0, 0, 0)) {
          console.log("in 2");
          document.querySelector('#L-shape').emit('L-shape-rotate2');
          console.log("in 2");
        }
        else if(checkValues(getAttrResult, 0, 90, 0)) {
          console.log("in 3");
          document.querySelector('#L-shape').emit('L-shape-rotate3');
        }
        else if(checkValues(getAttrResult, 0, 180, 0)) {
          console.log("in 4");
          document.querySelector('#L-shape').emit('L-shape-rotate4');
        } 
      });

      document.querySelector('body').addEventListener('keypress', function(event) {
        var getAttrResult=document.querySelector('#first-hint').getAttribute("position");
        if(event.keyCode == 104) {
          if (checkValues(getAttrResult, -50, 2, -30)) {
            document.querySelector("#first-hint").emit('hide-hint');
            document.querySelector("#second-hint").emit('hide-hint');
            document.querySelector("#third-hint").emit('hide-hint');
          }
          else {
          document.querySelector("#first-hint").emit('show-hint');
          document.querySelector("#second-hint").emit('show-hint');
          document.querySelector("#third-hint").emit('show-hint'); 
          }
        }
      });
    </script> 
  </body>
</html>


